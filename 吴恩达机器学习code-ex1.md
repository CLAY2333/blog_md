---
title: 吴恩达机器学习-ex1-说明书
date: 2018-09-15 22:07:25
categories: 机器学习
tags: [机器学习,编程,说明书]
---

<Excerpt in index | 首页摘要> 

这时候一份翻译过来的ex1的说明书，自用。如有错误勿怪。  

<!-- more -->

<The rest of contents | 余下全文>

# 编程练习1：线性回归

## 介绍

在本练习中，您将实现线性回归并使其看到它对数据起作用。 在开始此编程练习之前，我们强烈建议您观看视频讲座并完成相关主题的评论问题。要开始练习，您需要下载入门代码并将其内容解压缩到您希望完成练习的目录。 如果需要，在开始本练习之前，请使用Octave / MATLAB中的cd命令切换到此目录。您还可以在课程网站的“环境设置说明”中找到有关安装Octave / MATLAB的说明。

## 本练习中包含的文件

ex1.m - Octave / MATLAB脚本，引导您完成
exercise ex1 multi.m - Octave / MATLAB脚本，用于练习的后续部分
ex1data1.txt - 具有一个变量的线性回归数据集
ex1data2.txt - 带有多个变量的线性回归数据集
submit.m - 将解决方案发送到我们服务器的提交脚本

[⋆] warmUpExercise.m - Octave / MATLAB中的简单示例函数
[⋆] plotData.m - 显示数据集的函数
[⋆] computeCost.m - 计算线性回归成本的函数
[⋆] gradientDescent.m - 运行梯度下降的函数
[†] computeCostMulti.m - 多个变量的成本函数
[†] gradientDescentMulti.m - 多个变量的梯度下降
[†] featureNormalize.m - 规范化功能的功能
[†] normalEqn.m - 计算正规方程的函数

⋆表示您需要完成的文件
†表示可选练习

在整个练习中，您将使用脚本ex1.m和ex1 multi.m。 这些脚本为问题设置数据集，并调用您要编写的函数。 您无需修改其中任何一个。 您只需按照此分配中的说明修改其他文件中的功能。
对于此编程练习，您只需完成练习的第一部分即可使用一个变量实现线性回归。 练习的第二部分是可选的，涵盖了具有多个变量的线性回归。

## 哪里可以得到帮助

本课程中的练习使用Octave或MATLAB，这是一种非常适合数值计算的高级编程语言。 如果您没有安装Octave或MATLAB，请参阅课程网站“环境设置说明”中的安装说明。
在Octave / MATLAB命令行中，键入help后跟功能名称将显示内置函数的文档。 例如，帮助图将显示绘图的帮助信息。 有关Octave函数的更多文档，请参见Octave文档页面。 可以在MATLAB文档页面找到MATLAB文档。
我们还强烈建议您使用在线讨论与其他学生讨论练习。 但是，不要查看其他人编写的任何源代码或与他人共享您的源代码。

## 简单的Octave/MATLAB的函数

ex1.m的第一部分为您提供Octave / MATLAB语法和作业提交过程的练习。 在warmUpExercise.m文件中，您将找到Octave / MATLAB函数的大纲。 通过填写以下代码修改它以返回5 x 5单位矩阵：

~~~octave
A = eye(5);
~~~

完成后，运行ex1.m（假设您在正确的目录中，在Octave / MATLAB提示符下键入“ex1”），您应该看到类似于以下内容的输出：

```
ans =
Diagonal Matrix

			1	0	0	0	0 
			0	1	0	0	0 
			0	0	1	0	0 
			0	0	0	1	0 
			0	0	0	0	1
```

现在ex1.m将暂停，直到您按任意键，然后将运行代码的下一部分。 如果您想退出，键入ctrl-c将在运行过程中停止程序。

### 提交解决方案

完成部分练习后，您可以通过在Octave / MATLAB命令行输入提交来提交您的解决方案以进行评分。 子任务脚本将提示您输入登录电子邮件和提交令牌，并询问您要提交哪些文件。 您可以从网页获取作业的提交令牌。您现在应该提交您的解决方案。您可以多次提交您的解决方案，我们将仅考虑最高分。

## 带一个变量的线性回归

在本练习的这一部分中，您将使用一个变量实现线性回归，以预测食品卡车的利润。 假设您是一家餐厅特许经营店的首席执行官，并正考虑在不同的城市开设新店。 该连锁店已在各个城市拥有卡车，您可以获得来自城市的利润和人口数据。 

您希望使用此数据来帮助您选择要扩展到下一个城市。文件ex1data1.txt包含线性回归问题的数据集。 第一列是一个城市的人口，第二列是该城市的食品卡车的利润。 利润的负值表示亏损。已经设置了ex1.m脚本来为您加载此数据。

### 绘制数据

在开始执行任何任务之前，通过可视化来了解数据通常很有用。 对于此数据集，您可以使用散点图来可视化数据，因为它只有两个要绘制的属性（利润和总体）。 （在现实生活中你会遇到的许多其他问题都是多维的，无法在二维图上绘制。）
在ex1.m中，数据集从数据文件加载到变量X和y中：

~~~octave
data = load('ex1data1.txt');       % 读取逗号分隔数据
X = data(:, 1); y = data(:, 2);
m = length(y);                     % 一些训练样例
~~~

接下来，脚本调用plotData函数来创建数据的散点图。 你的工作是完成plotData.m绘制情节; 修改文件并填写以下代码：

~~~octave
  plot(x, y, 'rx', 'MarkerSize', 10); % Plot the data 
  ylabel('Profit in $10,000s'); % Set the y−axis label 
  xlabel('Population of City in 10,000s'); % Set the x−axis label
~~~

现在，当您继续运行ex1.m时，我们的最终结果应如图1所示，具有相同的红色“x”标记和轴标签。
要了解有关plot命令的更多信息，可以在Octave / MATLAB命令提示符下键入help plot，或在线搜索绘图文档。 （要将标记更改为红色“x”，我们将选项'rx'与plot命令一起使用，即plot（..，[your options here]，..，'rx'）;）

![image-20180906155604789](http://www.lzyclay.cn/md_img/ex1-1.png)

                                                                               图1：训练数据的散点图

### 梯度下降

在这一部分中，您将使用梯度下降将线性回归参数θ拟合到我们的数据集。

#### 更新方程式

线性回归的目标是最小化成本函数

![image-20180906155604789](http://www.lzyclay.cn/md_img/ex1-2.png)

其中假设hθ（x）由线性模型给出

![image-20180906155604789](http://www.lzyclay.cn/md_img/ex1-3.png)

回想一下，模型的参数是θj值。 这些是您将调整以最小化成本J（θ）的值。 一种方法是使用批量梯度下降算法。 在批处理梯度下降中，每次迭代都执行更新。

![image-20180906155604789](http://www.lzyclay.cn/md_img/ex1-2.png)（同时更新所有的θj）

随着梯度下降的每个步骤，您的参数θj更接近将达到最低成本J（θ）的最佳值。

* 实现注意：我们将每个示例作为一行存储在Octave / MATLAB的X矩阵中。 为了考虑截距项（θ0），我们在X中添加一个额外的第一列并将其设置为全部。 这使我们可以将θ0视为另一个“特征”。

#### 履行

在ex1.m中，我们已经设置了线性回归的数据。 在以下行中，我们为数据添加另一个维度以适应θ0截距项。 我们还将初始参数初始化为0，将学习率alpha初始化为0.01。

~~~octave
X = [ones(m, 1), data(:,1)]; % 在x中添加一列
theta = zeros(2, 1); % 初始化拟合参数
iterations = 1500;
alpha = 0.01;
~~~

#### 计算成本J（θ）

当您执行梯度下降以学习最小化成本函数J（θ）时，通过计算成本来监视收敛是有帮助的。 在本节中，您将实现一个计算J（θ）的函数，以便检查梯度下降实现的收敛性。
您的下一个任务是完成computeCost.m文件中的代码，该文件是计算J（θ）的函数。 在执行此操作时，请记住变量X和y不是标量值，而是其行代表训练集中的示例的矩阵。
完成该功能后，ex1.m中的下一步将使用θ初始化为零运行computeCost，您将看到打印到屏幕的成本。
您应该会看到32.07的成本。

您现在应该提交您的解决方案。

#### 梯度下降

接下来，您将在文件gradientDescent.m中实现渐变下降。循环结构已经为您编写，您只需要在每次迭代中提供θ的更新。
在编程时，请确保了解您要优化的内容以及正在更新的内容。请记住，成本J（θ）由矢量θ参数化，而不是X和y。也就是说，我们通过改变矢量θ的值而不是通过改变X或y来最小化J（θ）的值。如果您不确定，请参阅本讲义中的公式和视频讲座。
验证梯度下降是否正常工作的一种好方法是查看J（θ）的值，并检查它是否随着每一步减小。 gradientDescent.m的启动代码在每次迭代时调用computeCost并打印成本。假设您已正确实现了梯度下降和computeCost，则J（θ）的值不应该增加，并且应该在算法结束时收敛到稳定值。
完成后，ex1.m将使用您的最终参数绘制线性拟合。结果应如图2所示：
您对θ的最终价值也将用于预测35,000和70,000人的利润。请注意ex1.m中以下行使用矩阵乘法而不是显式求和或循环来计算预测的方式。这是Octave / MATLAB中代码矢量化的一个例子。
您现在应该提交您的解决方案。

~~~octave
predict1 = [1, 3.5] * theta;
predict2 = [1, 7] * theta;
~~~



### 调试

在实现梯度下降时，请记住以下几点：

* Octave / MATLAB数组索引从1开始，而不是零。 如果你在一个名为theta的向量中存储θ0和θ1，那么这些值将是theta（1）和theta（2）。

* 如果在运行时看到许多错误，请检查矩阵运算以确保添加和乘以兼容维的矩阵。 使用size命令打印变量的大小将有助于您进行调试。
* 默认情况下，Octave / MATLAB将数学运算符解释为矩阵运算符。 这是大小不兼容错误的常见来源。 如果您不想要矩阵乘法，则需要添加“点”符号以将其指定为Octave / MATLAB。 例如，A * B执行矩阵乘法，而A. * B执行逐元素乘法。

### 可视化J（θ）

为了更好地理解成本函数J（θ），您现在将绘制成本超过θ0和θ1值的二维网格。 您不需要为此部分编写任何新代码，但您应该了解您编写的代码是如何创建这些代码的。

在ex1.m的下一步中，有一些代码设置为使用您编写的computeCost函数计算值网格上的J（θ）。

~~~octave
%initialize J vals to a matrix of 0's
J vals = zeros(length(theta0 vals), length(theta1 vals));
% Fill out J vals
for i = 1:length(theta0 vals)
for j = 1:length(theta1 vals)
t = [theta0 vals(i); theta1 vals(j)];
J vals(i,j) = computeCost(x, y, t);
end end
~~~

执行这些行后，您将得到一个J（θ）值的二维数组。脚本ex1.m将使用这些值使用surf和contour命令生成J（θ）的曲面图和等高线图。 这些图的目的是向您展示J（θ）如何随θ0和θ1的变化而变化。 成本函数J（θ）是碗状的并且具有全局最小值。 （这在等高线图中比在3D表面图中更容易看到）。 该最小值是θ0和θ1的最佳点，并且梯度下降的每个步骤都移动到更接近该点。

### 可选练习

如果您已成功完成上述材料，恭喜！ 您现在了解线性回归，并且应该能够在您自己的数据集上开始使用它。

对于本次编程练习的其余部分，我们包括以下可选练习。 这些练习将帮助您更深入地了解材料，如果您能够这样做，我们也鼓励您完成这些练习。

## 具有多个变量的线性回归

在这一部分中，您将使用多个变量实现线性回归来预测房屋价格。 假设你在卖房子，你想知道什么是好的市场价格。 一种方法是首先收集有关最近出售的房屋的信息，并制定住房价格模型。
文件ex1data2.txt包含俄勒冈州Portland的住房价格培训。 第一列是房子的大小（平方英尺），第二列是卧室的数量，第三列是房子的价格。
已设置ex1 multi.m脚本以帮助您逐步完成此练习。

###特征规范化
ex1 multi.m脚本将首先加载并显示此数据集中的一些值。 通过查看值，请注意房屋大小约为卧室数量的1000倍。 当特征按强度顺序不同时，首先执行特征缩放可以使梯度下降更快地收敛。

您的任务是完成featureNormalize.m中的代码

* 从数据集中减去每个要素的平均值。

* 减去平均值后， “标准偏差”对特征值进行缩放（除法）

标准偏差是一种测量特定特征值范围内变化程度的方法（大多数数据点位于平均值的±2标准偏差范围内）;这是取值范围（max-min）的替代方法。在Octave / MATLAB中，您可以使用“std”函数来计算标准偏差。例如，在featureNormalize.m内，数量X（：，1）包含训练集中x1（房屋大小）的所有值，因此std（X（：，1））计算房屋大小的标准偏差。在调用featureNormalize.m时，对应于x0 = 1的1的额外列尚未添加到X（有关详细信息，请参阅ex1 multi.m）。
您将对所有功能执行此操作，并且您的代码应适用于所有大小的数据集（任意数量的功能/示例）。注意，矩阵X的每列对应于一个特征。
您现在应该提交您的解决方案。

* 实现注意：在对特征进行标准化时，重要的是存储用于标准化的值 - 用于计算的平均值和标准偏差。在从模型中学习参数后，我们经常想要预测以前从未见过的房屋价格。给定一个新的x值（起居室面积和卧室数量），我们必须首先使用我们之前从训练集计算出的平均值和标准差来标准化x。

### 3.2梯度下降

以前，您在单变量回归问题上实现了梯度下降。 现在唯一的区别是矩阵X中还有一个特征。假设函数和批量梯度下降更新规则保持不变。
您应该完成computeCostMulti.m和gradientDescentMulti.m中的代码，以实现线性回归的成本函数和梯度下降多个变量。 如果您的代码在上一部分（单个变量）已经存在支	持多个变量，你也可以在这里使用它。确保您的代码支持任意数量的功能并且具有良好的矢量化。 您可以使用'size（X，2）'来查找数据集中存在的特征数量。

您现在应该提交您的解决方案。

#### 选择学习率

在练习的这一部分中，您将尝试为数据集尝试不同的学习速率，并找到快速收敛的学习速率。您可以通过修改ex1 multi.m并更改设置学习速率的代码部分来更改学习速率。
ex1 multi.m中的下一个阶段将调用gradientDescent.m函数，并以所选学习速率运行梯度下降约50次迭代。该函数还应返回向量J中J（θ）值的历史。在最后一次迭代之后，ex1 multi.m脚本将J值与迭代次数进行对比。
如果您选择了一个良好范围内的学习率，您的情节看起来类似于图4.如果您的图表看起来非常不同，特别是如果您的J（θ）值增加甚至爆炸，请调整您的学习率并重试。我们建议在对数尺度上尝试学习率α的值，乘法步长约为先前值的3倍（即0.3,0.1,0.03,0.01等）。您可能还想调整正在运行的迭代次数，这样可以帮助您查看曲线中的整体趋势。

注意学习速率变化时收敛曲线的变化。 学习率很小，您会发现梯度下降需要很长时间才能收敛到最佳值。 相反，在学习率很高的情况下，梯度下降可能不会收敛甚至可能会发散！
使用您找到的最佳学习速率，运行ex1 multi.m脚本运行梯度下降直到收敛以找到θ的最终值。 接下来，使用此值θ来预测1650平方英尺和3间卧室的房屋价格。 稍后您将使用值来检查正常方程的实现。 进行此预测时，不要忘记将功能标准化！
您无需为这些可选（未评级）练习提交任何解决方案。

### 3.3 Normal Equations

在讲座视频中，您了解到线性回归的封闭形式解决方案

使用此公式不需要任何特征缩放，您将在一次计算中得到一个精确的解决方案：在梯度下降中没有“收敛之前的循环”。
完成normalEqn.m中的代码以使用上面的公式来计算θ。 请记住，虽然您不需要缩放功能，但我们仍需要在X矩阵中添加1列，以获得截距项（θ0）。 ex1.m中的代码会为您添加1的列到X.您现在应该提交您的解决方案。
可选（未评级）练习：现在，一旦你使用这种方法找到θ，用它来预测一个有3间卧室的1650平方英尺的房子。 您应该发现，使用与梯度下降拟合的模型得到的值与第3.2.1节中给出的值相同。

# 提交和评分

完成任务的各个部分后，请务必使用提交功能系统将您的解决方案提交给我们的服务器。 以下是对此练习的每个部分进行评分的细分。